<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Réinitialiser Admin (Local) - Atelier Confection</title>
  <link rel="stylesheet" href="css/admin.css" />
  <style>
    .reset-wrap { max-width: 680px; margin: 0 auto; padding: 24px; }
    .reset-card { background: #fff; border-radius: 14px; padding: 18px; box-shadow: 0 10px 30px rgba(0,0,0,.08); border: 1px solid rgba(0,0,0,.06); }
    .reset-card h1 { margin: 0 0 8px; font-size: 20px; }
    .reset-card p { margin: 0 0 14px; color: #6b7280; }
    .reset-actions { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
    .reset-actions .btn { display: inline-flex; align-items: center; gap: 10px; padding: 12px 14px; border-radius: 12px; border: none; cursor: pointer; font-weight: 700; }
    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
    .btn-secondary { background: #111827; color: white; }
    .btn-ghost { background: #f3f4f6; color: #111827; border: 1px solid #e5e7eb; }
    .status { margin-top: 14px; padding: 12px 14px; border-radius: 12px; border: 1px solid #e5e7eb; background: #f9fafb; color: #111827; }
    .status.success { border-color: #bbf7d0; background: #f0fdf4; color: #166534; }
    .status.error { border-color: #fecaca; background: #fef2f2; color: #991b1b; }
    code { background: #f3f4f6; padding: 2px 6px; border-radius: 8px; }
  </style>
</head>
<body class="login-page">
  <div class="login-container">
    <div class="reset-wrap">
      <div class="reset-card">
        <h1>Réinitialiser l’accès Admin (Local)</h1>
        <p>
          Cette page remet les identifiants admin par défaut (LocalStorage) et supprime la session en cours.
          Aucun SQL n’est nécessaire.
        </p>

        <div class="status" id="status">
          Identifiants par défaut : <strong>admin</strong> / <strong>admin123</strong>
        </div>

        <div class="reset-actions">
          <button class="btn btn-primary" id="btnReset" type="button">Réinitialiser</button>
          <button class="btn btn-secondary" id="btnGoLogin" type="button">Aller au login</button>
          <button class="btn btn-ghost" id="btnGoDashboard" type="button">Aller au dashboard</button>
        </div>

        <p style="margin-top:14px;color:#6b7280">
          Astuce : si tu avais changé le mot de passe avant, la réinitialisation remettra bien <code>admin123</code>.
        </p>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const USERS_KEY = 'atelier-admin-users';
      const AUTH_KEY = 'atelier-admin-auth';

      const defaultUsers = [
        {
          id: '1',
          username: 'admin',
          password: 'admin123',
          name: 'Administrateur',
          role: 'admin',
          email: 'admin@atelier-confection.com',
          createdAt: new Date().toISOString(),
        },
      ];

      const statusEl = document.getElementById('status');

      const setStatus = (kind, html) => {
        statusEl.className = 'status' + (kind ? ' ' + kind : '');
        statusEl.innerHTML = html;
      };

      document.getElementById('btnReset')?.addEventListener('click', () => {
        try {
          localStorage.setItem(USERS_KEY, JSON.stringify(defaultUsers));
          localStorage.removeItem(AUTH_KEY);
          setStatus(
            'success',
            '✅ Réinitialisation OK. Identifiants : <strong>admin</strong> / <strong>admin123</strong>.'
          );
        } catch (e) {
          setStatus('error', '❌ Erreur : ' + (e && e.message ? e.message : String(e)));
        }
      });

      document.getElementById('btnGoLogin')?.addEventListener('click', () => {
        window.location.href = 'index.html';
      });

      document.getElementById('btnGoDashboard')?.addEventListener('click', () => {
        window.location.href = 'dashboard.html';
      });
    })();
  </script>
</body>
</html>

